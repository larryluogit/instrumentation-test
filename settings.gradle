plugins {
  id 'com.gradle.enterprise' version '3.0'
}

def isCI = System.getenv("CI") != null
def skipBuildscan = Boolean.valueOf(System.getenv("SKIP_BUILDSCAN"))
gradleEnterprise {
  buildScan {
    termsOfServiceUrl = 'https://gradle.com/terms-of-service'
    termsOfServiceAgree = 'yes'

    if (isCI && !skipBuildscan) {
      publishAlways()
      tag 'CI'
    }
  }
}

rootProject.name = 'trace-java'

// agent projects
include ':java-agent'
include ':opentelemetry-sdk-shaded-for-testing'
include ':agent-bootstrap'
include ':agent-tooling'
include ':load-generator'

// misc
include ':testing'
include ':utils:gc-utils'
include ':utils:test-utils'

// smoke tests
include ':smoke-tests:cli'
include ':smoke-tests:java9-modules'
include ':smoke-tests:play'
include ':smoke-tests:springboot'
include ':smoke-tests:wildfly'

// instrumentation:
include ':instrumentation:akka-http-10.0'
include ':instrumentation:apache-httpasyncclient-4.0'
include ':instrumentation:apache-httpclient-4'
include ':instrumentation:aws-java-sdk-1.11'
include ':instrumentation:aws-java-sdk-2.2'
include ':instrumentation:cdi-1.2'
include ':instrumentation:couchbase-2.0'
include ':instrumentation:couchbase-2.6'
include ':instrumentation:datastax-cassandra-3'
include ':instrumentation:dropwizard-views-0.7'
include ':instrumentation:dropwizard-testing'
include ':instrumentation:elasticsearch'
include ':instrumentation:elasticsearch:rest-5'
include ':instrumentation:elasticsearch:rest-6.4'
include ':instrumentation:elasticsearch:transport-2'
include ':instrumentation:elasticsearch:transport-5'
include ':instrumentation:elasticsearch:transport-5.3'
include ':instrumentation:elasticsearch:transport-6'
include ':instrumentation:glassfish-3.0'
include ':instrumentation:google-http-client-1.19'
include ':instrumentation:grizzly-2'
include ':instrumentation:grpc-1.5'
include ':instrumentation:hibernate'
include ':instrumentation:hibernate:core-3.3'
include ':instrumentation:hibernate:core-4.0'
include ':instrumentation:hibernate:core-4.3'
include ':instrumentation:http-url-connection'
include ':instrumentation:hystrix-1.4'
include ':instrumentation:jax-rs-annotations-1'
include ':instrumentation:jax-rs-annotations-2'
include ':instrumentation:jax-rs-annotations-2:filter-jersey'
include ':instrumentation:jax-rs-annotations-2:filter-resteasy-3.0'
include ':instrumentation:jax-rs-annotations-2:filter-resteasy-3.1'
include ':instrumentation:jax-rs-client-1.1'
include ':instrumentation:jax-rs-client-2.0'
include ':instrumentation:jax-rs-client-2.0:connection-error-handling-jersey'
include ':instrumentation:jax-rs-client-2.0:connection-error-handling-resteasy'
include ':instrumentation:java-concurrent'
include ':instrumentation:java-concurrent:kotlin-testing'
include ':instrumentation:java-concurrent:scala-testing'
include ':instrumentation:java-concurrent:akka-testing'
include ':instrumentation:java-concurrent:akka-2.5-testing'
include ':instrumentation:jboss-classloading'
include ':instrumentation:jdbc'
include ':instrumentation:jedis-1.4'
include ':instrumentation:jedis-3.0'
include ':instrumentation:jetty-8'
include ':instrumentation:jms-1.1'
include ':instrumentation:jsp-2.3'
include ':instrumentation:kafka-clients-0.11'
include ':instrumentation:kafka-streams-0.11'
include ':instrumentation:lettuce-5'
// FIXME this instrumentation relied on scope listener
// include ':instrumentation:log4j1'
// FIXME this instrumentation relied on scope listener
// include ':instrumentation:log4j2'
include ':instrumentation:mongo'
include ':instrumentation:mongo:driver-3.1'
include ':instrumentation:mongo:driver-async-3.3'
include ':instrumentation:netty-4.0'
include ':instrumentation:netty-4.1'
include ':instrumentation:okhttp-3'
include ':instrumentation:osgi-classloading'
include ':instrumentation:play-2.4'
include ':instrumentation:play-2.6'
include ':instrumentation:play-ws-1'
include ':instrumentation:play-ws-2'
include ':instrumentation:play-ws-2.1'
include ':instrumentation:rabbitmq-amqp-2.7'
include ':instrumentation:ratpack-1.4'
include ':instrumentation:reactor-core-3.1'
include ':instrumentation:rmi'
include ':instrumentation:rxjava-1'
include ':instrumentation:servlet'
include ':instrumentation:servlet:request-2'
include ':instrumentation:servlet:request-3'
// FIXME this instrumentation relied on scope listener
// include ':instrumentation:slf4j-mdc'
include ':instrumentation:sparkjava-2.3'
include ':instrumentation:spring-data-1.8'
include ':instrumentation:spring-webmvc-3.1'
include ':instrumentation:spring-webflux-5'
include ':instrumentation:spymemcached-2.12'
include ':instrumentation:tomcat-classloading'
include ':instrumentation:trace-annotation'
include ':instrumentation:twilio-6.6'
include ':instrumentation:vertx-testing'

// benchmark
include ':benchmark'
include ':benchmark-integration'
include ':benchmark-integration:jetty-perftest'
include ':benchmark-integration:play-perftest'

def setBuildFile(project) {
  project.buildFileName = "${project.name}.gradle"
  project.children.each {
    setBuildFile(it)
  }
}

setBuildFile(rootProject)

project(':java-agent').name = 'opentelemetry-auto'
