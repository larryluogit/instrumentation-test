ext {
  maxJavaVersionForTests = JavaVersion.VERSION_1_8
  skipPublish = true
}

apply from: "$rootDir/gradle/instrumentation.gradle"

dependencies {
  testInstrumentation project(':instrumentation:servlet:servlet-3.0:javaagent')
  testInstrumentation project(':instrumentation:servlet:servlet-javax-common:javaagent')
  testInstrumentation project(':instrumentation:grizzly-2.0:javaagent')

  testCompileOnly "org.glassfish.main.common:scattered-archive-api:4.1"
  testCompileOnly "org.glassfish.main.common:simple-glassfish-api:4.1"
  testCompileOnly "javax.servlet:javax.servlet-api:3.0.1"
  if (!testLatestDeps) {
    testRuntimeOnly "org.glassfish.main.extras:glassfish-embedded-all:4.1"
  } else {
    testRuntimeOnly "org.glassfish.main.extras:glassfish-embedded-all:5.1.0"
  }
}

tasks.withType(Test).configureEach {
  jvmArgs "-Djava.awt.headless=true"
}
